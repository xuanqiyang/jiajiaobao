require.config({paths:{jquery:"lib/jquery",validate:"lib/jquery.validate.min",messages:"lib/messages_zh.min",superSlide:"lib/jquery.SuperSlide",lazyload:"lib/jquery.lazyload.min",art:"lib/jquery.artDialog",webuploader:"lib/webuploader"},shim:{validate:{deps:["jquery"],exports:"validate"},messages:{deps:["jquery","validate"],exports:"messages"},superSlide:{deps:["jquery"],exports:"superSlide"},lazyload:{deps:["jquery"],exports:"lazyload"},art:{deps:["jquery"],exports:"art"},webuploader:{exports:"webuploader"}}}),define("starScore",["jquery"],function(e){return{scoreFun:function(t,a){function i(e,a){var i=parseInt(e)+1,s=c*i,n=p*i;o=u>5?options.types[parseInt(e)]:options.types[parseInt(e)+10],t.find("a").removeClass("clibg"),a.addClass("clibg"),a.css({width:s,left:"0"}),r.text(n),d.text(o)}var s={fen_d:22,ScoreGrade:5,types:["很不满意","差得离谱","不满意","描述严重不符,不满意","一般","质量一般","没卖家描述的那么好","满意","质量不错,还是挺满意的","非常满意","很差","差","一般","好","很好"],parent:"star-score",nameScore:"fenshu",attitude:"attitude"};options=e.extend({},s,a);var n,o,r=t.find("."+options.nameScore),l=t.find("."+options.parent),d=t.find("."+options.attitude),c=options.fen_d,u=options.ScoreGrade;if(l.length>0){l.width(c*u);for(var p=5/u,f=0;f<u;f++){var m=e("<a href='javascript:void(0)'></a>");m.css({left:0,width:c*(f+1),"z-index":u-f}),m.appendTo(l)}e("#option-menu li").click(function(){i(4,l.find("a"))}),l.find("a").each(function(t,a){e(this).click(function(){n=t,i(t,e(this))}),e(this).mouseenter(function(){i(t,e(this))}),e(this).mouseleave(function(){if(n>=0){var t=p*(parseInt(n)+1);l.find("a").removeClass("clibg"),l.find("a").eq(n).addClass("clibg");var a=c*(parseInt(n)+1);l.find("a").eq(n).css({width:a,left:"0"}),r&&(r.text(t),e(".score").val(t))}else l.find("a").removeClass("clibg"),r&&(r.text(""),e(".score").val(""))})})}}}}),require(["webuploader"],function(e){!function(t){t(function(){function a(e){var a=t('<li id="'+e.id+'"><p class="title">'+e.name+'</p><p class="imgWrap"></p><p class="progress"><span></span></p></li>'),i=t('<div class="file-panel"><span class="cancel">删除</span><span class="rotateRight">向右旋转</span><span class="rotateLeft">向左旋转</span></div>').appendTo(a),s=a.find("p.progress span"),n=a.find("p.imgWrap"),o=t('<p class="error"></p>'),l=function(e){switch(e){case"exceed_size":text="文件大小超出";break;case"interrupt":text="上传暂停";break;default:text="上传失败，请重试"}o.text(text).appendTo(a)};"invalid"===e.getStatus()?l(e.statusText):(n.text("预览中"),r.makeThumb(e,function(e,a){var i;e?n.text("不能预览"):x?(i=t('<img src="'+a+'">'),n.empty().append(i)):t.ajax("../../server/preview.php",{method:"POST",data:a,dataType:"json"}).done(function(e){e.result?(i=t('<img src="'+e.result+'">'),n.empty().append(i)):n.text("预览出错")})},b,w),k[e.id]=[e.size,0],e.rotation=0),e.on("statuschange",function(t,n){"progress"===n?s.hide().width(0):"queued"===n&&(a.off("mouseenter mouseleave"),i.remove()),"error"===t||"invalid"===t?(console.log(e.statusText),l(e.statusText),k[e.id][1]=1):"interrupt"===t?l("interrupt"):"queued"===t?(o.remove(),s.css("display","block"),k[e.id][1]=0):"progress"===t?(o.remove(),s.css("display","block")):"complete"===t&&(s.hide().width(0),a.append('<span class="success"></span>')),a.removeClass("state-"+n).addClass("state-"+t)}),a.on("mouseenter",function(){i.stop().animate({height:30})}),a.on("mouseleave",function(){i.stop().animate({height:0})}),i.on("click","span",function(){var a;switch(t(this).index()){case 0:return void r.removeFile(e);case 1:e.rotation+=90;break;case 2:e.rotation-=90}S?(a="rotate("+e.rotation+"deg)",n.css({"-webkit-transform":a,"-mos-transform":a,"-o-transform":a,transform:a})):n.css("filter","progid:DXImageTransform.Microsoft.BasicImage(rotation="+~~(e.rotation/90%4+4)%4+")")}),a.appendTo(d)}function i(e){var a=t("#"+e.id);delete k[e.id],s(),a.off().find(".file-panel").off().end().remove()}function s(){var e,a=0,i=0,s=m.children();t.each(k,function(e,t){i+=t[0],a+=t[0]*t[1]}),e=i?a/i:0,s.eq(0).text(Math.round(100*e)+"%"),s.eq(1).css("width",Math.round(100*e)+"%"),n()}function n(){var t,a="";"ready"===y?a="选中"+h+"张图片，共"+e.formatSize(v)+"。":"confirm"===y?(t=r.getStats()).uploadFailNum&&(a="已成功上传"+t.successNum+"张照片至XX相册，"+t.uploadFailNum+'张照片上传失败，<a class="retry" href="#">重新上传</a>失败图片或<a class="ignore" href="#">忽略</a>'):(t=r.getStats(),a="共"+h+"张（"+e.formatSize(v)+"），已上传"+t.successNum+"张",t.uploadFailNum&&(a+="，失败"+t.uploadFailNum+"张")),u.html(a)}function o(e){var a;if(e!==y){switch(p.removeClass("state-"+y),p.addClass("state-"+e),y=e){case"pedding":f.removeClass("element-invisible"),d.hide(),c.addClass("element-invisible"),r.refresh();break;case"ready":f.addClass("element-invisible"),t(".filePicker2").removeClass("element-invisible"),d.show(),c.removeClass("element-invisible"),r.refresh();break;case"uploading":t(".filePicker2").addClass("element-invisible"),m.show(),p.text("暂停上传");break;case"paused":m.show(),p.text("继续上传");break;case"confirm":if(m.hide(),t(".filePicker2").removeClass("element-invisible"),p.text("开始上传"),(a=r.getStats()).successNum&&!a.uploadFailNum)return void o("finish");break;case"finish":(a=r.getStats()).successNum?alert("上传成功"):(y="done",location.reload())}n()}}var r,l=t(".uploader"),d=t('<ul class="filelist"></ul>').appendTo(l.find(".queueList")),c=l.find(".statusBar"),u=c.find(".info"),p=l.find(".uploadBtn"),f=l.find(".placeholder"),m=c.find(".progress").hide(),h=0,v=0,g=window.devicePixelRatio||1,b=110*g,w=110*g,y="pedding",k={},x=function(){var e=new Image,t=!0;return e.onload=e.onerror=function(){1==this.width&&1==this.height||(t=!1)},e.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==",t}(),C=function(){var e;try{e=navigator.plugins["Shockwave Flash"],e=e.description}catch(t){try{e=new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version")}catch(t){e="0.0"}}return e=e.match(/\d+/g),parseFloat(e[0]+"."+e[1],10)}(),S=function(){var e=document.createElement("p").style,t="transition"in e||"WebkitTransition"in e||"MozTransition"in e||"msTransition"in e||"OTransition"in e;return e=null,t}();e.Uploader.support("flash")||!e.browser.ie?e.Uploader.support()?((r=e.create({pick:{id:".filePicker",label:"点击选择图片"},formData:{uid:123},paste:".uploader",swf:"./Uploader.swf",chunked:!1,chunkSize:524288,server:"../../server/fileupload.php",disableGlobalDnd:!0,fileNumLimit:5,fileSizeLimit:209715200,fileSingleSizeLimit:52428800})).on("dndAccept",function(e){for(var t=!1,a=e.length,i=0;i<a;i++)if(~"text/plain;application/javascript ".indexOf(e[i].type)){t=!0;break}return!t}),r.on("dialogOpen",function(){console.log("here")}),r.addButton({id:".filePicker2",label:"继续添加"}),r.on("ready",function(){window.uploader=r}),r.onUploadProgress=function(e,a){t("#"+e.id).find(".progress span").css("width",100*a+"%"),k[e.id][1]=a,s()},r.onFileQueued=function(e){h++,v+=e.size,1===h&&(f.addClass("element-invisible"),c.show()),a(e),o("ready"),s()},r.onFileDequeued=function(e){h--,v-=e.size,h||o("pedding"),i(e),s()},r.on("all",function(e){switch(e){case"uploadFinished":o("confirm");break;case"startUpload":o("uploading");break;case"stopUpload":o("paused")}}),r.onError=function(e){alert("Eroor: "+e)},p.on("click",function(){if(t(this).hasClass("disabled"))return!1;"ready"===y?r.upload():"paused"===y?r.upload():"uploading"===y&&r.stop()}),u.on("click",".retry",function(){r.retry()}),u.on("click",".ignore",function(){alert("todo")}),p.addClass("state-"+y),s()):alert("Web Uploader 不支持您的浏览器！"):C?function(t){window.expressinstallcallback=function(e){switch(e){case"Download.Cancelled":alert("您取消了更新！");break;case"Download.Failed":alert("安装失败");break;default:alert("安装已成功，请刷新！")}delete window.expressinstallcallback};var a="./expressInstall.swf",i='<object type="application/x-shockwave-flash" data="'+a+'" ';e.browser.ie&&(i+='classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" '),i+='width="100%" height="100%" style="outline:0"><param name="movie" value="'+a+'" /><param name="wmode" value="transparent" /><param name="allowscriptaccess" value="always" /></object>',t.html(i)}(l):l.html('<a href="http://www.adobe.com/go/getflashplayer" target="_blank" border="0"><img alt="get flash player" src="http://www.adobe.com/macromedia/style_guide/images/160x41_Get_Flash_Player.jpg" /></a>')})}(jQuery)}),require(["jquery","art","starScore"],function(e,t,a){function i(e){0==r?(e.removeAttribute("disabled"),e.innerText="获取验证码",r=60):(e.setAttribute("disabled",!0),e.innerText=r,r--,setTimeout(function(){i(e)},1e3))}a.scoreFun(e(".stars")),e(".rated span").each(function(t,a){var i=2*e(this).attr("tip")*11;e(this).css("width",i)});var s=document.getElementById("showServeTerms"),n=(document.getElementById("serveTermsDialog"),document.getElementById("getCode")),o=document.getElementById("cellphone"),r=60,l=/^(((13[0-9]{1})|(15[0-9]{1})|(18[0-9]{1})|(17[0-9]{1}))+\d{8})$/,d=e(".form-tab label"),c=e(".form-body"),u=document.getElementById("showUploader");document.getElementById("uploaderDialog");d.bind("click",function(t){e(this).index()?c[0].action="http://www.baidu.com/":c[0].action="http://www.google.com/",e(this).addClass("active").siblings("label").removeClass("active")}),e(".selector .option").each(function(){e(this).find("dl dd a").click(function(){e(this).addClass("active").siblings().removeClass("active")})}),n&&(n.onclick=function(e){11==o.value.length&&l.test(o.value)?i(this):t.dialog({title:"登录提示",content:"请填写手机号码!",lock:!0,fixed:!0}).show()}),u&&(u.onclick=function(){t.dialog({title:"文件上传",lock:!0,fixed:!0,content:document.getElementById("uploaderDialog"),okVal:"保存",ok:function(){},cancelVal:"关闭",cancel:!0}).show()}),s&&(s.onclick=function(){t.dialog({title:"家教宝服务协议",lock:!0,fixed:!0,content:document.getElementById("serveTermsDialog"),okVal:"同意",ok:function(){document.getElementById("agreeServeTerms").checked="checked"},cancelVal:"关闭",cancel:!0}).show()})}),require(["jquery","lazyload","superSlide"],function(e){jQuery(".focus").hover(function(){jQuery(this).find(".prev,.next").stop(!0,!0).fadeTo("show",.2)},function(){jQuery(this).find(".prev,.next").fadeOut()}),jQuery(".focus").slide({mainCell:".pic",effect:"fold",autoPlay:!0,delayTime:600,trigger:"click"}),e("img.lazy").lazyload({placeholder:"../images/loading.gif",effect:"fadeIn"});var t=[],a=e(".search-form"),i=e(".placeholder"),s=e(".form-text");t.push(a.data("placeholder"),a.data("courseplaceholder"),a.data("orgplaceholder")),e(".search-tab .tab-item").click(function(){i.text(t[e(this).index()]),e(this).addClass("active").siblings(".tab-item").removeClass("active")}),s.each(function(){var t=e(this).siblings(".placeholder"),a=e(this);""!=e(this).val()?t.hide():t.show(),t.click(function(){a.trigger("focus")}),e(this).focus(function(){t.hide()}).blur(function(){""!=e(this).val()?t.hide():t.show()})});var n=e(".menu li"),o=e(".menu"),r=e(".sub-menu"),l=e(".sub-menu-content");e(".folder").length>0&&(o.css("display","none"),e(".menu-title").mouseover(function(){e(".menu").show()}),e(".all-couser").mouseleave(function(){e(".menu").hide(),n.removeClass("active")})),n.mouseover(function(){var t=e(this).index();n.removeClass("active"),e(this).addClass("active"),l.hide(),r.show(),l.eq(t).show()}),e(".menu-wrapper").mouseleave(function(){l.hide(),r.hide(),n.removeClass("active")})});